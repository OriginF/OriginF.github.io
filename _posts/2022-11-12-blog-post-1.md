---
title: 'Computational Geometry'
date: 2022-11-12
permalink: /posts/2022/11/12/blog-post-1/
tags:
  - Convex Hull
  - Geometry Intersection
  - Triangulation


---

计算几何知识点总结及归纳



### 计算几何

#### 1.凸包

凸多边形，凸包

判断点在向量的左边还是右边：叉乘/面积法

判断点在三角形里面还是外面：三个边各用一次上面的方法

形成凸包的方法：

- baseline垃圾算法：遍历找最左

- 使用栈的思想：O(n^2)但是非常敏感，所以很优秀
  - 找到LTL
  - 预处理所有的边为逆时针存储
  - 使用栈的思想
  - 01.CH.H.GS.Example.pdf，每次出栈和入栈

- 类似插入排序，一个点一个点往里面加：O(nlogn)
  - 判断点是否在凸包里面：使用预处理边的顺序（向量），然后进行二分查找
  - 找到对应的需要进行增设的凸包的两个端点：采用遍历的方法，找到L+L和R+R的点
- 类似归并排序，现将所有的边都划分成小组，直到只剩三个点O(nlogn)
  - 两两归并的方法：
    - 可以使用上述的栈的方法：如果可以找到一个点同时在两个集合里面
    - 可以采用上述插入排序的方法，如果可以找到一个点在一个集合而不在另一个集合
  - 如果预先采用了x排序，使得每个需要归并的集合是水平分离的：
    - 维护每个集合的最左点和最右点，上端点和下端点
    - 每次连接上端点和下端点，使用最左到最右的方法进行追赶算法

#### 2.几何求交

- 判断一维线段是否有交点:

  - 类似于括号匹配算法，将一个线段的左端点染色为红色，右端点染为蓝色，然后，红加红，必有交点。
  - 入栈出栈的思想

- 二维线段是否有交点:

  - 如果只有两条线段：四次To-Left判定

  - 如果是多条线段：没讲，但是我觉得用的不多，可以采用向x，y轴投影的方法？

- 一群二维线段求交点：

  - 扫描线算法
  - 两个数据结构：02.GI.D.BO.Strategy.pdf
    - 状态结构：从下到上记录当前活跃的所有的点（一般使用BBST）
    - 事件序列：记录所有的将来可能发生的事件，使用优先级队列

- 两个凸包是否有交点
  - 每个凸包按照最高点和最低点二分
  - 拓展集合
  - 有交点相当于A左和B右相交$\or$是A右和B左相交
  - 一半相交的判定方法：二分法 02.GI.G.CPID.pdf
    - 先找到两个中间的线段，扩展为边判断其交点
    - 如果交点在上面：如果$e_A$在$e_B$上面，那么可以去掉B的下面一部分，反之亦然。
    - 如果交点在下面：同上
    - 如果交点在一个下面，另一个线段上，那么可以舍去两条线段的上面部分。反之亦然。
    - 如果交点在一个上面，另一个线段上，同上。
    - 如果交点在两条线段上：终止判定。

- 两个多边形求交点 
  - 边追赶算法O(n+m) 02.GI.H.Edge Chasing.pdf
    - 两个凸包对边自排序
    - 不断的逆序遍历一个凸包，直到边与另一个凸包的起始边有交点
    - 然后更换遍历和等待的凸包，继续运动，直到回到最初的两条边。
  - 扫描线算法O(n+m) 02.GI.I.Plane Sweep.pdf
    - 类似上面的那个求多个线段的交点的方法，但是少了很多个极限的情况，因此，会比较省事

#### 3.三角化

（这一章有跟前两章不同，很多很多证明，我看了，但是，看完感觉用不到，所以就不列举了）

- monotone有序：竖直方向上为一个函数
- 将一个多边形拆分为多个monotone有序的多边形的方法： 03.PT.E3.Triangulation.Properties.pdf
  - 采用扫描线算法，维护一个或者是多个helper点，找到对应的梯形的下端点。
  - 每次左右出现端点，更新helper，helper为这个端点
  - 每次出现上内凸点，分为两个梯形，公用一个helper，为这个上凸点。
  - 每次出现上外凸点，多加一个梯形（三角形），helper为这个上凸点。
  - 每次出现下内凸点，结束两个梯形，开启一个新的梯形，helper更新为这个下内凸点。
  - 每次出现下外凸点，结束一个梯形。
- 对于一个monotone有序的梯形进行三角化：03.PT.F.Triangulating Monotone POLYGONS.pdf
  - 采用栈的思想
  - 左右均有序
  - 类似归并排序，找到左右的一个公共次序
  - 一个一个入栈和出栈
  - 规则：
    - 连接下栈内两个点，和上栈顶点，为钝角，入栈
    - 为锐角，弹出栈顶，并形成一条分割线，重复第一步。
    - 直到只剩两个点。

#### 4.平面分割

- 存储Voronoi图的方法是仅仅存储其所有的分割边而非以其所有的面为对象存储